{"version":3,"sources":["touchController.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","touchNode","Node","_xStart","_xEnd","_yStart","_yEnd","canTouch","onLoad","on","EventType","TOUCH_START","touchStart","TOUCH_END","touchEnd","instance","registerEvent","disableTouch","bind","start","update","dt","event","getLocationX","getLocationY","touchMove","Math","abs","emit","error","value"],"mappings":";;;;;;AAAA,IAAMA,UAAUC,QAAQ,UAAR,CAAhB;;AAEAC,GAAGC,KAAH,CAAS;AACPC,WAASF,GAAGG,SADL;;AAGPC,cAAY;AACVC,eAAWL,GAAGM,IADJ;AAEVC,aAAS,CAFC;AAGVC,WAAO,CAHG;AAIVC,aAAS,CAJC;AAKVC,WAAO,CALG;AAMVC,cAAU;AANA,GAHL;;AAYP;;AAEAC,QAdO,oBAcE;AACP,SAAKP,SAAL,CAAeQ,EAAf,CAAkBb,GAAGM,IAAH,CAAQQ,SAAR,CAAkBC,WAApC,EAAiD,KAAKC,UAAtD,EAAkE,IAAlE;AACA,SAAKX,SAAL,CAAeQ,EAAf,CAAkBb,GAAGM,IAAH,CAAQQ,SAAR,CAAkBG,SAApC,EAA+C,KAAKC,QAApD,EAA8D,IAA9D;AACApB,YAAQqB,QAAR,CAAiBC,aAAjB,CAA+B,eAA/B,EAAgD,KAAKC,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAhD;AACA,SAAKD,YAAL,CAAkB,KAAlB;AACD,GAnBM;AAqBPE,OArBO,mBAqBC,CAAE,CArBH;AAuBPC,QAvBO,kBAuBAC,EAvBA,EAuBI,CAAE,CAvBN;AAyBPT,YAzBO,sBAyBIU,KAzBJ,EAyBW;AAChB,SAAKnB,OAAL,GAAemB,MAAMC,YAAN,EAAf;AACA,SAAKlB,OAAL,GAAeiB,MAAME,YAAN,EAAf;AACD,GA5BM;AA6BPV,UA7BO,oBA6BEQ,KA7BF,EA6BS;AACd,SAAKlB,KAAL,GAAakB,MAAMC,YAAN,EAAb;AACA,SAAKjB,KAAL,GAAagB,MAAME,YAAN,EAAb;AACA,SAAKC,SAAL;AACD,GAjCM;AAkCPA,WAlCO,uBAkCK;AACV,QAAI,CAAC,KAAKlB,QAAV,EAAoB;;AAEpB,QAAI,KAAKJ,OAAL,IAAgB,IAAhB,IAAwB,KAAKE,OAAL,IAAgB,IAAxC,IAAgD,KAAKD,KAAL,IAAc,IAA9D,IAAsE,KAAKE,KAAL,IAAc,IAAxF,EAA8F;AAC5F,UAAIoB,KAAKC,GAAL,CAAS,KAAKvB,KAAL,GAAa,KAAKD,OAA3B,IAAsCuB,KAAKC,GAAL,CAAS,KAAKrB,KAAL,GAAa,KAAKD,OAA3B,CAA1C,EAA+E;AAC7E,YAAI,KAAKD,KAAL,GAAa,KAAKD,OAAtB,EAA+B;AAC7BT,kBAAQqB,QAAR,CAAiBa,IAAjB,CAAsB,WAAtB;AACD,SAFD,MAEO;AACLlC,kBAAQqB,QAAR,CAAiBa,IAAjB,CAAsB,UAAtB;AACD;AACF,OAND,MAMO;AACL,YAAI,KAAKtB,KAAL,GAAa,KAAKD,OAAtB,EAA+B;AAC7BX,kBAAQqB,QAAR,CAAiBa,IAAjB,CAAsB,QAAtB;AACD,SAFD,MAEO;AACLlC,kBAAQqB,QAAR,CAAiBa,IAAjB,CAAsB,UAAtB;AACD;AACF;AACF,KAdD,MAcOhC,GAAGiC,KAAH,CAAS,UAAT;AACR,GApDM;AAqDPZ,cArDO,wBAqDMa,KArDN,EAqDa;AAClB,SAAKvB,QAAL,GAAgBuB,KAAhB;AACD;AAvDM,CAAT","file":"touchController.js","sourceRoot":"../../../../assets/Script","sourcesContent":["const Emitter = require(\"mEmitter\");\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    touchNode: cc.Node,\n    _xStart: 0,\n    _xEnd: 0,\n    _yStart: 0,\n    _yEnd: 0,\n    canTouch: true,\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    this.touchNode.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n    this.touchNode.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\n    Emitter.instance.registerEvent(\"DISABLE TOUCH\", this.disableTouch.bind(this));\n    this.disableTouch(false);\n  },\n\n  start() {},\n\n  update(dt) {},\n\n  touchStart(event) {\n    this._xStart = event.getLocationX();\n    this._yStart = event.getLocationY();\n  },\n  touchEnd(event) {\n    this._xEnd = event.getLocationX();\n    this._yEnd = event.getLocationY();\n    this.touchMove();\n  },\n  touchMove() {\n    if (!this.canTouch) return;\n\n    if (this._xStart != null && this._yStart != null && this._xEnd != null && this._yEnd != null) {\n      if (Math.abs(this._xEnd - this._xStart) > Math.abs(this._yEnd - this._yStart)) {\n        if (this._xEnd > this._xStart) {\n          Emitter.instance.emit(\"KEY RIGHT\");\n        } else {\n          Emitter.instance.emit(\"KEY LEFT\");\n        }\n      } else {\n        if (this._yEnd > this._yStart) {\n          Emitter.instance.emit(\"KEY UP\");\n        } else {\n          Emitter.instance.emit(\"KEY DOWN\");\n        }\n      }\n    } else cc.error(\"ERROR!!!\");\n  },\n  disableTouch(value) {\n    this.canTouch = value;\n  },\n});\n"]}