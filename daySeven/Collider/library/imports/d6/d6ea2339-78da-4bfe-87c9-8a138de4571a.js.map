{"version":3,"sources":["../../../../assets/Script/assets/Script/objectB.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","canMove","canJump","objectSb","sp","Skeleton","mainCharacter","Node","onLoad","manager","director","getCollisionManager","enabled","enabledDebugDraw","instance","registerEvent","goAttack_Action","bind","goLeft_Action","goRight_Action","goJump_Action","resetPos_Action","start","update","dt","node","y","setAnimation","addAnimation","goLeft","spawn","moveBy","scaleTo","runAction","goRight","scaleX","currentDirection","goJump","sequence","callFunc","easing","easeExponentialIn","resetPos","moveTo","rotateTo","goShoot","log","v2","onCollisionEnter","other","self","console","tag","onCollisionStay","onCollisionExit"],"mappings":"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","file":"objectB.js","sourceRoot":"../../../../assets/Script","sourcesContent":["const Emitter = require(\"mEmitter\");\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    canMove: false,\n    canJump: false,\n    objectSb: sp.Skeleton,\n    mainCharacter: cc.Node,\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    let manager = cc.director.getCollisionManager();\n    manager.enabled = true;\n    manager.enabledDebugDraw = true;\n    // let move = cc.moveBy(100, 10000, 0);\n    // this.node.runAction(move);\n    Emitter.instance = new Emitter();\n\n    Emitter.instance.registerEvent(\n      \"ATTACK_ACTION\",\n      this.goAttack_Action.bind(this)\n    );\n    Emitter.instance.registerEvent(\n      \"LEFT_ACTION\",\n      this.goLeft_Action.bind(this)\n    );\n    Emitter.instance.registerEvent(\n      \"RIGHT_ACTION\",\n      this.goRight_Action.bind(this)\n    );\n    Emitter.instance.registerEvent(\n      \"JUMP_ACTION\",\n      this.goJump_Action.bind(this)\n    );\n    Emitter.instance.registerEvent(\n      \"RESET_ACTION\",\n      this.resetPos_Action.bind(this)\n    );\n  },\n\n  start() {},\n\n  update(dt) {\n    // this.node.x += dt * 100;\n    if (this.node.y <= 270) {\n      this.node.y = 170;\n    }\n  },\n  goAttack_Action() {\n    this.objectSb.setAnimation(0, \"shoot\", false);\n    this.objectSb.addAnimation(0, \"run\", false);\n    this.objectSb.addAnimation(0, \"run\", false);\n    // this.attackSound.play();\n  },\n  goLeft_Action() {\n    let goLeft = cc.spawn(cc.moveBy(0.5, -80, 0), cc.scaleTo(0, -0.4, 0.4));\n    this.mainCharacter.runAction(goLeft);\n    this.objectSb.setAnimation(0, \"run\", false);\n    this.objectSb.addAnimation(0, \"idle\", false);\n  },\n  goRight_Action() {\n    let goRight = cc.spawn(cc.moveBy(0.5, +80, 0), cc.scaleTo(0, 0.4, 0.4));\n    this.mainCharacter.runAction(goRight);\n    this.objectSb.setAnimation(0, \"run\", false);\n    this.objectSb.addAnimation(0, \"idle\", false);\n  },\n  goJump_Action() {\n    if (this.mainCharacter.scaleX == -0.4) {\n      this.currentDirection = -80;\n    } else this.currentDirection = +80;\n    let goJump = cc.sequence(\n      cc.callFunc(() => {\n        this.objectSb.setAnimation(0, \"jump\", false);\n        this.objectSb.addAnimation(0, \"idle\", false);\n      }),\n      cc.moveBy(0.4, 0, +120),\n      cc.moveBy(0.4, this.currentDirection, 0),\n      cc.moveBy(0.4, 0, -120)\n    );\n    goJump.easing(cc.easeExponentialIn(3.0));\n    this.mainCharacter.runAction(goJump);\n  },\n  resetPos_Action() {\n    let resetPos = cc.spawn(\n      cc.moveTo(0, -700, 170),\n      cc.scaleTo(0, 0.4, 0.4),\n      cc.rotateTo(0, 0)\n    );\n    this.mainCharacter.runAction(resetPos);\n\n    this.objectSb.setAnimation(0, \"idle\", false);\n  },\n  goShoot() {\n    // let stop = cc.moveBy(0.5, 0, 0);\n    // let stop = cc.sequence(\n    //   cc.delayTime(0.5),\n    //   cc.callFunc(() => {\n    //     this.objectSb.setAnimation(0, \"shoot\", false);\n    //   })\n    // );\n    // this.node.runAction(stop);\n    cc.log(\"shoot\");\n    this.objectSb.setAnimation(0, \"shoot\", false);\n    this.objectSb.addAnimation(0, \"run\", false);\n    this.objectSb.addAnimation(0, \"run\", false);\n  },\n  goJump() {\n    let sequence = cc.sequence(\n      cc.moveBy(0.5, cc.v2(120, 150)),\n      cc.moveBy(0.5, cc.v2(0, -150))\n    );\n    this.node.runAction(sequence);\n\n    this.objectSb.setAnimation(0, \"jump\", false);\n  },\n  onCollisionEnter(other, self) {\n    console.log(\"on collision enter\");\n    if (self.tag === 0) this.goJump();\n    if (other.tag === 0) this.goAttack_Action();\n  },\n\n  onCollisionStay(other, self) {\n    console.log(\"on collision stay\");\n  },\n  onCollisionExit(other, self) {\n    console.log(\"on collision exit\");\n    this.objectSb.setAnimation(0, \"run\", true);\n  },\n});\n"]}